@using System.Globalization;
@model List<BaiTap_23WebC_Nhom10.Models.Product>

@foreach (var p in Model)
{
    var culture = new CultureInfo("vi-VN");
    var discountRate = p.Discount / 100;
    var discountedPrice = p.Price * (1 - discountRate);

    var formattedDiscountedPrice = string.Format(culture, "{0:C0}", discountedPrice).Replace("₫", "VNĐ");
    var formattedOriginalPrice = string.Format(culture, "{0:C0}", p.Price).Replace("₫", "VNĐ");

   
    var imgMain = p.ProductImages?.FirstOrDefault(i => i.IsMain)?.ImagePath ?? "/img/no-image.png";

    <div class="col-md-3 col-sm-6 product-item" style="height:450px">
        <div class="single-shop-product">
            <div class="product-upper">
               
                <img style="width: 300px; height: 300px; object-fit: cover;"
                     src="@Url.Content(imgMain)"
                     alt="@p.ProductName"
                     onerror="this.src='/img/no-image.png';" />
            </div>
            <h2 class="text-center" style="font-size:16px; height:48px; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">
                <a asp-controller="Product" asp-action="Detail" asp-route-slug="@p.Slug">@p.ProductName</a>
            </h2>
            <div class="product-carousel-price text-center">
                <ins>@formattedDiscountedPrice</ins> <del>@formattedOriginalPrice</del>
            </div>
            <div class="product-option-shop text-center mt-3">
                <a class="add_to_cart_button" data-quantity="1" href="#">Add to cart</a>
            </div>
        </div>
    </div>
}
